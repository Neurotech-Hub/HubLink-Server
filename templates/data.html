{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Device Filter Pills -->
    <div hx-get="{{ url_for('accounts.device_pills', account_url=account.url) }}" hx-trigger="every 60s"
        hx-swap="innerHTML">
        {% include 'partials/device_pills.html' %}
    </div>

    <!-- File Table -->
    <div class="row"
        hx-get="{{ url_for('accounts.file_table', account_url=account.url, device_id=device_id, total_limit=total_limit) }}"
        hx-trigger="every 30s" hx-swap="innerHTML" hx-indicator="#spinner">

        <!-- Add this somewhere visible -->
        <div id="spinner" class="htmx-indicator">
            <small class="text-muted">Updating...</small>
        </div>

        {% include 'partials/file_table.html' %}
    </div>

    <!-- Delete Files Button -->
    {% if device_id %}
    <div class="d-flex justify-content-end mt-5">
        <form action="/{{ account.url }}/data" method="POST" class="d-inline"
            onsubmit="return confirm('Are you sure you want to delete all files for device {{ device_id }}?');">
            <input type="hidden" name="device_id" value="{{ device_id }}">
            <button type="submit" class="btn btn-outline-danger shadow-sm px-4">
                Delete Files for {{ device_id }}
            </button>
        </form>
    </div>
    {% endif %}
</div>

<!-- Your existing modal code -->
{% endblock %}